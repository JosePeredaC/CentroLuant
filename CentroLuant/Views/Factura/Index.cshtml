@model CentroLuant.Models.FacturaBuscarViewModel

@{
    ViewData["Title"] = "Facturación";
}

<style>
    .fact-panel-wrapper {
        max-width: 900px;
        margin: 0 auto;
        padding: 24px 20px 40px;
    }

    .fact-search-card {
        background: #ffffff;
        border-radius: 16px;
        border: 1px solid #E2E8F0;
        box-shadow: 0 10px 28px rgba(15,23,42,0.08);
        padding: 22px 24px 26px;
        margin-bottom: 18px;
    }

    .fact-title {
        font-size: 1.4rem;
        font-weight: 700;
        color: #0F172A;
        margin-bottom: 4px;
    }

    .fact-subtitle {
        font-size: .9rem;
        color: #64748B;
        margin-bottom: 0;
    }

    .fact-section-title {
        font-size: .8rem;
        text-transform: uppercase;
        letter-spacing: .12em;
        color: #94A3B8;
        font-weight: 600;
        margin-bottom: 8px;
        margin-top: 14px;
    }

    .form-label {
        font-size: .9rem;
        font-weight: 500;
        color: #0F172A;
    }

    .form-control {
        border-radius: 10px;
        border-color: #E2E8F0;
    }

    .small-muted {
        font-size: .8rem;
        color: #94A3B8;
    }
</style>

<div class="fact-panel-wrapper">
    <div class="fact-search-card">
        <div class="mb-3">
            <h2 class="fact-title">Módulo de facturación</h2>
            <p class="fact-subtitle">
                Busque al paciente por DNI o nombre para generar la factura de los servicios brindados.
            </p>
        </div>

        <form method="get" class="row g-3 align-items-end">
            <div class="col-md-6">
                <label class="form-label">Paciente</label>
                <input type="text"
                       name="termino"
                       class="form-control"
                       placeholder="DNI o nombre del paciente"
                       value="@Model.Termino" />
                <div class="small-muted mt-1">
                    Puede escribir solo el DNI, nombres o apellidos.
                </div>
            </div>
            <div class="col-md-3 d-flex align-items-end">
                <button class="btn btn-primary w-100">
                    Buscar
                </button>
            </div>
        </form>

        @if (!string.IsNullOrEmpty(Model.Mensaje))
        {
            <div class="alert alert-warning mt-3 mb-0">
                @Model.Mensaje
            </div>
        }
    </div>

    @if (Model.Resultados != null && Model.Resultados.Any())
    {
        <div class="fact-search-card">
            <div class="fact-section-title">Resultados</div>

            <div class="table-responsive">
                <table class="table table-sm align-middle mb-0">
                    <thead class="table-light">
                        <tr>
                            <th>DNI</th>
                            <th>Paciente</th>
                            <th>Contacto</th>
                            <th class="text-end">Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var p in Model.Resultados)
                        {
                            <tr>
                                <td>@p.DNI</td>
                                <td>@p.Nombres @p.Apellidos</td>
                                <td>
                                    <span class="small-muted">
                                        Tel: @(p.Telefono ?? "-") · Correo: @(p.CorreoElectronico ?? "-")
                                    </span>
                                </td>
                                <td class="text-end">
                                    <a asp-action="Servicios"
                                       asp-route-dni="@p.DNI"
                                       class="btn btn-sm btn-outline-primary">
                                        Generar factura
                                    </a>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
</div>
